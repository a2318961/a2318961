import{s as C,f as E}from"./utils.367f4380.js";const N=Vue.createElementVNode("div",{style:{padding:"20px","font-size":"16px","font-weight":"bold","text-align":"center"}}," \u5230\u7AD9\u67E5\u8BE2\u5DE5\u5177 ",-1),S={key:0},I=Vue.createTextVNode("\u6682\u65E0\u7AD9\u53F0\uFF0C\u53BB\u6DFB\u52A0"),w={key:1},T={style:{padding:"10px","min-height":"calc(100vh - 175px)"}},D={key:0},L={key:1},F={key:2},R={key:0,style:{"font-size":"12px","text-align":"center",padding:"15px 0"}},H={setup(z){const _=VueRouter.useRouter(),u=Vue.ref(""),c=Vue.ref(!0),d=Vue.ref([]),s=Vue.ref([]),V=Vue.ref(""),f=()=>{let e=JSON.parse(localStorage.getItem("stationList"))||[];s.value=e;const t=localStorage.getItem("tabIndex");k(t)},k=e=>{var t;if(e)u.value=e,localStorage.setItem("tabIndex",e);else{const o=(t=s.value[0])==null?void 0:t.stopId;o&&(u.value=o)}},m=(e=!1)=>{if(console.log("showMessage",e),s.value.length==0||!u.value)return;const t=s.value.find(o=>o.stopId==u.value);c.value=!0,C(t.stopId).then(o=>{const p=o.data.data||[],a={};p.forEach(i=>{i.lines.forEach(l=>{a[l.lineNo]||(a[l.lineNo]=[]),l.nextStop=i.nextStop,a[l.lineNo].push(l)})}),d.value=a,console.log("obj",a),V.value=E(new Date),setTimeout(()=>{e&&vant.Toast("\u5237\u65B0\u6210\u529F"),c.value=!1},600)}).catch(o=>{setTimeout(()=>{},600),vant.Toast("\u5237\u65B0\u5931\u8D25"),c.value=!1})},g=()=>{m(!0)},h=e=>{_.push(`/line/${e}`)},B=e=>{console.log("handleTabChange",e),localStorage.setItem("tabIndex",e)};return f(),Vue.watchEffect(()=>m(!1)),(e,t)=>{const o=Vue.resolveComponent("van-button"),p=Vue.resolveComponent("van-empty"),a=Vue.resolveComponent("van-tab"),i=Vue.resolveComponent("van-tabs"),l=Vue.resolveComponent("van-icon"),x=Vue.resolveComponent("van-row"),y=Vue.resolveComponent("van-pull-refresh");return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[N,s.value.length==0?(Vue.openBlock(),Vue.createElementBlock("div",S,[Vue.createVNode(p,{image:"search"},{default:Vue.withCtx(()=>[Vue.createVNode(o,{type:"danger",icon:"plus",to:"/stationList",class:"bottom-button"},{default:Vue.withCtx(()=>[I]),_:1})]),_:1})])):(Vue.openBlock(),Vue.createElementBlock("div",w,[Vue.createVNode(y,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=n=>c.value=n),onRefresh:g},{default:Vue.withCtx(()=>[Vue.createVNode(i,{active:u.value,"onUpdate:active":t[0]||(t[0]=n=>u.value=n),onChange:B,ellipsis:!1},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(s.value,n=>(Vue.openBlock(),Vue.createBlock(a,{key:n.stopId,name:n.stopId,title:n.name},null,8,["name","title"]))),128))]),_:1},8,["active"]),Vue.createElementVNode("div",T,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(d.value,(n,v)=>(Vue.openBlock(),Vue.createElementBlock("div",{key:v,class:"bus-item"},[Vue.createTextVNode(" \u7EBF\u8DEF"+Vue.toDisplayString(v)+" ",1),(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(n,(r,b)=>(Vue.openBlock(),Vue.createBlock(x,{key:b,style:{"margin-top":"5px"},justify:"space-between",onClick:U=>h(r.lineId)},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",null,"\u5F00\u5F80"+Vue.toDisplayString(r.nextStop)+"\u65B9\u5411",1),Vue.createElementVNode("div",null,[r.nearBus>0?(Vue.openBlock(),Vue.createElementBlock("span",D,Vue.toDisplayString(r.nearBus)+"\u7AD9",1)):r.nearBus==0?(Vue.openBlock(),Vue.createElementBlock("span",L,"\u5373\u5C06\u5230\u7AD9")):(Vue.openBlock(),Vue.createElementBlock("span",F,"\u6682\u65E0\u4FE1\u606F")),Vue.createVNode(l,{style:{"margin-left":"10px"},name:"arrow"})])]),_:2},1032,["onClick"]))),128))]))),128)),V.value?(Vue.openBlock(),Vue.createElementBlock("div",R," \u66F4\u65B0\u65F6\u95F4\uFF1A"+Vue.toDisplayString(V.value),1)):Vue.createCommentVNode("",!0)])]),_:1},8,["modelValue"])]))],64)}}};export{H as default};
